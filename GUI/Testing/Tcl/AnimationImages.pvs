set kw(vtkTemp1) [$Application GetMainWindow]
set kw(vtkTemp43) [$kw(vtkTemp1) GetMainView]

source [file join [file dirname [info script]] CommandLineOptions.tcl]
ParseCommandLine $kw(vtkTemp43) $argv $argc

$kw(vtkTemp43) SetOrientationAxesVisibility 0

# Create sphere
set kw(vtkTemp898) [$kw(vtkTemp1) CreatePVSource SphereSource]
set kw(vtkTemp904) [$kw(vtkTemp898) GetPVWidget {Center}]
$kw(vtkTemp904) SetValue 0 0 0
set kw(vtkTemp909) [$kw(vtkTemp898) GetPVWidget {Radius}]
$kw(vtkTemp909) SetValue 0.5
set kw(vtkTemp913) [$kw(vtkTemp898) GetPVWidget {Theta Resolution}]
$kw(vtkTemp913) SetValue 8
set kw(vtkTemp918) [$kw(vtkTemp898) GetPVWidget {Start Theta}]
$kw(vtkTemp918) SetValue 0
set kw(vtkTemp923) [$kw(vtkTemp898) GetPVWidget {End Theta}]
$kw(vtkTemp923) SetValue 360
set kw(vtkTemp928) [$kw(vtkTemp898) GetPVWidget {Phi Resolution}]
$kw(vtkTemp928) SetValue 8
set kw(vtkTemp933) [$kw(vtkTemp898) GetPVWidget {Start Phi}]
$kw(vtkTemp933) SetValue 0
set kw(vtkTemp938) [$kw(vtkTemp898) GetPVWidget {End Phi}]
$kw(vtkTemp938) SetValue 180
$kw(vtkTemp1) SetCenterOfRotation 0.000000 0.000000 0.000000
$kw(vtkTemp898) AcceptCallback

# Create animation
$kw(vtkTemp1) ShowAnimationProperties
set kw(vtkTemp164) [$kw(vtkTemp1) GetAnimationInterface]
set kw(vtkTemp187) [$kw(vtkTemp164) GetSourceEntry 0]
$kw(vtkTemp187) SetPVSource $kw(vtkTemp898)
$kw(vtkTemp923) AnimationMenuCallback $kw(vtkTemp187)
$kw(vtkTemp164) SetNumberOfFrames 3
$kw(vtkTemp187) SetTimeStart 20.000000
$kw(vtkTemp187) SetTimeEnd 200.000000

# Save animation images
$kw(vtkTemp164) SaveImages "$TempDir/AnimationImages" {png} 300 300
$kw(vtkTemp164) SetAnimationTime 1

set didRegression 0

for {set i  1} {$i < [expr $argc - 1]} {incr i} {
    if {[lindex $argv $i] == "-C"} {
	source [lindex $argv [expr $i + 1]]
	$Application SetExitStatus [ComparePNG "$TempDir/AnimationImages0001" {}]
        set didRegression 1
    }
}

if { ! $didRegression } {
    set colorMaps [[$Application GetMainWindow] GetPVColorMaps]
    $colorMaps InitTraversal
    while { 1 } {
        set colorMap [$colorMaps GetNextItemAsObject]
        if { $colorMap == {} } {
            break
        }
        $colorMap SetScalarBarVisibility 0
    }
   for {set i  1} {$i < [expr $argc - 1]} {incr i} {
      if {[lindex $argv $i] == "-BT"} {
         source [lindex $argv [expr $i + 1]]
         file delete "$TempDir/AnimationImagesbatch00000.png"
         file delete "$TempDir/AnimationImagesbatch00001.png"
         file delete "$TempDir/AnimationImagesbatch00002.png"
      }
   }
}

file delete "$TempDir/AnimationImages0000.png"
file delete "$TempDir/AnimationImages0001.png"
file delete "$TempDir/AnimationImages0002.png"
file delete "$TempDir/AnimationImages0003.png"

$Application Exit

