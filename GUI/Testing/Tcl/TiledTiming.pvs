set kw(vtkTemp4) [$Application GetMainWindow]
set kw(vtkTemp24) [$kw(vtkTemp4) GetMainView]
$kw(vtkTemp24) SetOrientationAxesVisibility 0

source [file join [file dirname [info script]] CommandLineOptions.tcl]
ParseCommandLine $kw(vtkTemp24) $argv $argc

$Application ExitAfterLoadScriptOff

set t0 [clock clicks -milliseconds]
set FrameLogFile "TiledTiming_FrameLog.txt"
set FrameLogFileId [open $TempDir/$FrameLogFile "a"]
set EventLogFile "TiledTiming_Event.txt"
set EventLogFileId [open $TempDir/$EventLogFile "a"]
puts $EventLogFileId "Start [clock format [clock seconds] -format "%H:%M:%S"] [clock seconds] [clock clicks -milliseconds]"
flush $EventLogFileId

set et1 [clock clicks -milliseconds]
puts -nonewline $EventLogFileId "Source_superquadric [clock format [clock seconds] -format "%H:%M:%S"] [clock seconds] [clock clicks -milliseconds]"
flush $EventLogFileId
set et1 [clock clicks -milliseconds]
set kw(vtkTemp897) [$kw(vtkTemp4) CreatePVSource SuperquadricSource]
set kw(vtkTemp903) [$kw(vtkTemp897) GetPVWidget {Center}]
$kw(vtkTemp903) SetValue 0 0 0
set kw(vtkTemp908) [$kw(vtkTemp897) GetPVWidget {Scale}]
$kw(vtkTemp908) SetValue 1 1 1
set kw(vtkTemp914) [$kw(vtkTemp897) GetPVWidget {ThetaResolution}]
$kw(vtkTemp914) SetValue 16
set kw(vtkTemp919) [$kw(vtkTemp897) GetPVWidget {PhiResolution}]
$kw(vtkTemp919) SetValue 16
set kw(vtkTemp924) [$kw(vtkTemp897) GetPVWidget {Thickness}]
$kw(vtkTemp924) SetValue 0.3333
set kw(vtkTemp928) [$kw(vtkTemp897) GetPVWidget {ThetaRoundness}]
$kw(vtkTemp928) SetValue 1
set kw(vtkTemp931) [$kw(vtkTemp897) GetPVWidget {PhiRoundness}]
$kw(vtkTemp931) SetValue 1
set kw(vtkTemp934) [$kw(vtkTemp897) GetPVWidget {Size}]
$kw(vtkTemp934) SetValue 0.5
set kw(vtkTemp937) [$kw(vtkTemp897) GetPVWidget {Toroidal}]
$kw(vtkTemp937) SetSelectedState 1
$kw(vtkTemp897) AcceptCallback
set elapsed [expr {([clock clicks -milliseconds] - $et1) / 1000.0}]
puts $EventLogFileId " [clock seconds] [clock clicks -milliseconds] $elapsed"
flush $EventLogFileId

for {set idx 0} {$idx < 5} {incr idx} {
  $kw(vtkTemp4) ResetCameraCallback
  set i 300
  set j 300

  # Rotate
  puts "Spin: i=$i j=$j"
  set et1 [clock clicks -milliseconds]
  puts -nonewline $EventLogFileId "Rotate [clock format [clock seconds] -format "%H:%M:%S"] [clock seconds] $et1"
  flush $EventLogFileId
  $kw(vtkTemp4) InvokeInteractorEvent "LeftButtonPressEvent"
  update

  set ft1 [clock clicks -milliseconds]
  for {set i 0} {$i < 400} {incr i 10} {
    $kw(vtkTemp4) SetInteractorEventInformation $i $j 0 0 0 0 0
    $kw(vtkTemp4) InvokeInteractorEvent "MouseMoveEvent"
    update
    set t [clock clicks -milliseconds]
    set elapsed [expr {($t - $ft1) / 1000.0}]
    if {$elapsed == 0} then {set $elapsed 0.000001}
    set framerate [expr {1.0/$elapsed}]
    set foo [expr [clock seconds] + $t - $t0]
    puts $FrameLogFileId [format "Rotate %d %18.9f %f %f" $i $foo $elapsed $framerate]
    set ft1 $t
  }
  $kw(vtkTemp4) InvokeInteractorEvent "LeftButtonReleaseEvent"
  update
  set elapsed [expr {([clock clicks -milliseconds] - $et1) / 1000.0}]
  puts $EventLogFileId " [clock seconds] [clock clicks -milliseconds] $elapsed"
  flush $EventLogFileId

  # Zoom
  puts "Zoom: i=$i j=$j"
  set et1 [clock clicks -milliseconds]
  puts -nonewline $EventLogFileId "Zoom [clock format [clock seconds] -format "%H:%M:%S"] [clock seconds] $et1"
  flush $EventLogFileId
  $kw(vtkTemp4) SetInteractorEventInformation $i $j 0 0 0 0 0
  $kw(vtkTemp4) InvokeInteractorEvent "RightButtonPressEvent"
  update

  set ft1 [clock clicks -milliseconds]
  for {set j 300} {$j > 160} {incr j -10} {
    $kw(vtkTemp4) SetInteractorEventInformation $i $j 0 0 0 0 0
    $kw(vtkTemp4) InvokeInteractorEvent "MouseMoveEvent"
    update
    set t [clock clicks -milliseconds]
    set elapsed [expr {($t - $ft1) / 1000.0}]
    if {$elapsed == 0} then {set $elapsed 0.000001}
    set framerate [expr {1.0/$elapsed}]
    set foo [expr [clock seconds] + $t - $t0]
    puts $FrameLogFileId [format "Zoom %d %18.9f %f %f" $j $foo $elapsed $framerate]
    set ft1 $t
  }
  $kw(vtkTemp4) InvokeInteractorEvent "RightButtonReleaseEvent"
  update
  set elapsed [expr {([clock clicks -milliseconds] - $et1) / 1000.0}]
  puts $EventLogFileId " [clock seconds] [clock clicks -milliseconds] $elapsed"
  flush $EventLogFileId

  # Translate
  puts "Translate: i=$i j=$j"
  set et1 [clock clicks -milliseconds]
  puts -nonewline $EventLogFileId "Translate [clock format [clock seconds] -format "%H:%M:%S"] [clock seconds] $et1"
  flush $EventLogFileId
  $kw(vtkTemp4) InvokeInteractorEvent "MiddleButtonPressEvent"
  update

  set ft1 [clock clicks -milliseconds]
  for {set i -400} {$i < 600} {incr i 100} {
    $kw(vtkTemp4) SetInteractorEventInformation $i $j 0 0 0 0 0
    $kw(vtkTemp4) InvokeInteractorEvent "MouseMoveEvent"
    update
    set t [clock clicks -milliseconds]
    set elapsed [expr {($t - $ft1) / 1000.0}]
    if {$elapsed == 0} then {set $elapsed 0.000001}
    set framerate [expr {1.0/$elapsed}]
    set foo [expr [clock seconds] + $t - $t0]
    puts $FrameLogFileId [format "Translate %d %18.9f %f %f" $i $foo $elapsed $framerate]
    set ft1 $t
  }
  $kw(vtkTemp4) InvokeInteractorEvent "MiddleButtonReleaseEvent"
  update
  set elapsed [expr {([clock clicks -milliseconds] - $et1) / 1000.0}]
  puts $EventLogFileId " [clock seconds] [clock clicks -milliseconds] $elapsed"

  flush $EventLogFileId
  flush $FrameLogFileId
}
